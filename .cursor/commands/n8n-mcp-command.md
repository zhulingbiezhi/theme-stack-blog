# n8n Workflow 助手命令

## 快速命令

### 创建新工作流
```
创建一个 n8n 工作流来 [描述业务场景]
```

**示例**：
- 创建一个 n8n 工作流来监控 GitHub issues 并发送到 Slack
- 创建一个 n8n 工作流来每天定时备份数据库
- 创建一个 n8n 工作流来处理 webhook 请求并保存到 MySQL

---

### 搜索和使用模板
```
搜索 n8n 模板：[关键词]
```

```
部署 n8n 模板 ID：[模板ID]
```

**示例**：
- 搜索 n8n 模板：chatbot
- 搜索 n8n 模板：database sync
- 部署 n8n 模板 ID：1234

---

### 节点操作
```
查找 n8n 节点：[关键词]
```

```
获取 n8n 节点配置：[节点类型]
```

**示例**：
- 查找 n8n 节点：webhook
- 查找 n8n 节点：database
- 获取 n8n 节点配置：nodes-base.slack

---

### 工作流管理
```
验证 n8n 工作流 [工作流ID]
```

```
测试 n8n 工作流 [工作流ID]
```

```
自动修复 n8n 工作流 [工作流ID]
```

```
查看 n8n 工作流版本历史 [工作流ID]
```

```
回滚 n8n 工作流到版本 [工作流ID] [版本ID]
```

**示例**：
- 验证 n8n 工作流 abc123
- 测试 n8n 工作流 abc123
- 自动修复 n8n 工作流 abc123
- 查看 n8n 工作流版本历史 abc123

---

### 执行监控
```
查看 n8n 工作流执行历史 [工作流ID]
```

```
获取 n8n 执行详情 [执行ID]
```

**示例**：
- 查看 n8n 工作流执行历史 abc123
- 获取 n8n 执行详情 exec-123

---

### 高级操作
```
给 n8n 工作流 [工作流ID] 添加节点：[节点类型]，配置：[配置描述]
```

```
连接 n8n 工作流 [工作流ID] 的节点 [源节点] 到 [目标节点]
```

```
更新 n8n 工作流 [工作流ID] 的节点 [节点名] 配置：[配置描述]
```

**示例**：
- 给 n8n 工作流 abc123 添加节点：nodes-base.slack，配置：发送消息到 #general 频道
- 连接 n8n 工作流 abc123 的节点 Webhook 到 Slack
- 更新 n8n 工作流 abc123 的节点 HTTP_Request 配置：添加 Bearer token 认证

---

## 工作流设计指南

### 创建工作流时遵循的原则

1. **单一职责**：每个工作流只处理一个明确的业务场景
2. **错误处理**：关键节点必须配置错误输出
3. **幂等性**：支持重复执行的节点要设计幂等检查
4. **可观测性**：关键节点添加日志记录

### 标准开发流程

1. **搜索节点** → 查找所需功能的节点
2. **获取配置** → 了解节点参数和配置项
3. **创建结构** → 创建工作流基础框架
4. **增量更新** → 逐步添加节点和连接
5. **验证测试** → 验证配置并测试执行

### 模板优先策略

- 先搜索模板库，看是否有现成模板可用
- 找到相关模板后，查看模板配置学习最佳实践
- 可以直接部署模板，然后根据需求调整

---

## 常见场景模板

### Webhook 处理
```
创建一个 n8n 工作流：
1. 接收 webhook 请求
2. 验证请求签名
3. 处理数据并保存到数据库
4. 返回响应
```

### 定时任务
```
创建一个 n8n 工作流：
1. 每天 8:00 触发
2. 从 API 获取数据
3. 数据转换和清洗
4. 保存到数据库
5. 发送执行报告邮件
```

### 消息通知
```
创建一个 n8n 工作流：
1. 监听特定事件
2. 格式化消息内容
3. 发送到 Slack/Discord/邮件
4. 记录发送日志
```

### 数据同步
```
创建一个 n8n 工作流：
1. 从源系统获取数据
2. 数据转换和映射
3. 同步到目标系统
4. 错误重试和日志记录
```

---

## 工具说明

### 节点搜索和配置
- `search_nodes`: 按关键词搜索节点
- `get_node`: 获取节点详细配置（优先使用 detail='standard'）
- `validate_node`: 验证单个节点配置

### 模板操作
- `search_templates`: 搜索模板库
- `get_template`: 获取模板详情
- `n8n_deploy_template`: 部署模板到 n8n 实例

### 工作流管理
- `n8n_create_workflow`: 创建新工作流
- `n8n_get_workflow`: 获取工作流详情
- `n8n_update_partial_workflow`: 增量更新工作流
- `n8n_list_workflows`: 列出所有工作流

### 验证和测试
- `validate_workflow`: 验证工作流完整性
- `n8n_validate_workflow`: 验证已部署的工作流
- `n8n_test_workflow`: 测试执行工作流

### 版本控制
- `n8n_workflow_versions`: 查看版本历史
- 支持回滚到指定版本
- 支持版本清理和裁剪

### 执行监控
- `n8n_executions`: 查看执行历史
- 支持按工作流、状态筛选
- 可获取执行详细数据

### 自动修复
- `n8n_autofix_workflow`: 自动修复常见问题
  - 表达式格式错误
  - typeVersion 不匹配
  - 错误输出配置
  - webhook 路径缺失

---

## 注意事项

1. **环境配置**：确保已配置 `N8N_API_URL` 和 `N8N_API_KEY`
2. **节点类型**：节点类型必须包含 `nodes-base.` 或 `nodes-langchain.` 前缀
3. **先验证后部署**：部署前务必使用 `validate_workflow` 验证
4. **版本备份**：重要变更前查看版本历史，必要时先回滚测试
5. **测试优先**：使用 `n8n_test_workflow` 在安全环境测试新工作流

---

## 参考资源

- **n8n 官方文档**: https://docs.n8n.io
- **模板库**: https://n8n.io/workflows
- **社区模板**: https://github.com/Zie619/n8n-workflows
- **获取工具详细文档**: `使用 tools_documentation 获取完整工具说明`

