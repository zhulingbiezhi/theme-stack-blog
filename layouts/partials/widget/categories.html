{{- $hasCategories := .Site.Taxonomies.categories -}}
{{- $categoriesCount := len .Site.Taxonomies.categories -}}

{{- if $hasCategories -}}
<section class="widget categories">
    <div class="widget-icon">
        {{ partial "helper/icon" "infinity" }}
    </div>
    <h2 class="widget-title section-title">分类 ({{ $categoriesCount }})</h2>
    <div class="widget-body">
        <div class="category-list">
            {{- range first 10 (sort .Site.Taxonomies.categories "Count" "desc") }}
            <div class="category-list-item">
                <a href="{{ .Page.RelPermalink }}" class="category-list-link">
                    {{ .Page.Title }} <span class="category-list-count">({{ .Count }})</span>
                </a>
            </div>
            {{- end }}
        </div>
    </div>
</section>
{{- else -}}
<div style="color: red;">DEBUG: No categories taxonomy found! Count: {{ $categoriesCount }}</div>
{{- end -}}